# 🏆 実績システム 設計案（4-3）

## 概要
特定の条件を達成するとバッジを獲得できる実績システムを実装します。

---

## 1. 実績のカテゴリ

### 1-1. 釣果系（Catch）
- **初めての一匹** 🎣: 初めて魚を釣る
- **10匹達成** 🐟: 合計10匹の魚を釣る
- **100匹達成** 🐠: 合計100匹の魚を釣る
- **500匹達成** 🐡: 合計500匹の魚を釣る
- **1000匹達成** 🌊: 合計1000匹の魚を釣る
- **5000匹達成** 🏆: 合計5000匹の魚を釣る

### 1-2. レア度系（Rarity）
- **レア魚ゲッター** ⭐: レア度「rare」の魚を初めて釣る
- **エピックハンター** ⭐⭐: レア度「epic」の魚を初めて釣る
- **レジェンダリー** ⭐⭐⭐: レア度「legendary」の魚を初めて釣る
- **コモンマスター** 🐟: レア度「common」の全種類を釣る
- **アンコモンマスター** 🐠: レア度「uncommon」の全種類を釣る
- **レアマスター** ⭐: レア度「rare」の全種類を釣る
- **エピックマスター** ⭐⭐: レア度「epic」の全種類を釣る
- **レジェンダリーマスター** ⭐⭐⭐: レア度「legendary」の全種類を釣る

### 1-3. 図鑑系（Collection）
- **図鑑スタート** 📖: 図鑑に5種類の魚を登録
- **図鑑コレクター** 📚: 図鑑に10種類の魚を登録
- **図鑑マスター** 📘: 図鑑に15種類の魚を登録
- **完全制覇** 🏅: 図鑑に全種類（19種類）の魚を登録

### 1-4. レベル系（Level）
- **レベル5達成** ⭐: レベル5に到達
- **レベル10達成** ⭐⭐: レベル10に到達
- **レベル20達成** ⭐⭐⭐: レベル20に到達
- **レベル30達成** 🌟: レベル30に到達
- **レベル50達成** 🌟🌟: レベル50に到達

### 1-5. 経済系（Money）
- **初めての収益** 💰: 合計100Gを獲得
- **小金持ち** 💰💰: 合計10,000Gを獲得
- **富豪** 💰💰💰: 合計100,000Gを獲得
- **大富豪** 💰💰💰💰: 合計500,000Gを獲得
- **億万長者** 💎: 合計1,000,000Gを獲得

### 1-6. 竿・装備系（Equipment）
- **竿コレクター** 🎣: 全種類の竿を購入（5種類）
- **エサマスター** 🪱: 全種類のエサを購入（3種類）
- **ルアーマスター** 🪝: 全種類のルアーを購入（3種類）
- **装備コンプリート** ⚔️: 全種類の竿・エサ・ルアーを購入

### 1-7. 特殊系（Special）
- **連続成功** 🔥: 連続5回成功で魚を釣る
- **パーフェクト** ✨: 連続10回成功で魚を釣る
- **不運の始まり** 🗑️: 初めてゴミを釣る
- **ゴミハンター** 🗑️🗑️: ゴミを10個釣る

---

## 2. データ構造

### 2-1. 実績定義（AchievementConfig）
```typescript
export interface AchievementConfig {
  id: string;                    // 実績ID（例: "catch_10"）
  category: string;              // カテゴリ（"catch", "rarity", "collection", etc.）
  name: string;                  // 実績名（例: "10匹達成"）
  description: string;           // 説明文
  emoji: string;                 // 表示用絵文字
  condition: AchievementCondition; // 達成条件
  reward?: AchievementReward;   // 報酬（オプション）
}

export interface AchievementCondition {
  type: string;                 // 条件タイプ（"total_caught", "level", "money", etc.）
  target: number;               // 目標値
  fishId?: string;              // 特定の魚ID（オプション）
  rarity?: string;              // 特定のレア度（オプション）
}

export interface AchievementReward {
  money?: number;               // 報酬のお金
  exp?: number;                 // 報酬の経験値
  item?: {                      // 報酬のアイテム
    type: string;                // "rod", "bait", "lure"
    id: string;
  };
}
```

### 2-2. プレイヤーデータへの追加
```typescript
// PlayerData に追加
export interface PlayerData {
  // ... 既存のフィールド ...
  
  // 実績システム
  achievements: Set<string>;           // 獲得済み実績IDのセット
  achievementProgress: Map<string, number>; // 実績の進捗（key: 実績ID, value: 現在の値）
  totalMoneyEarned: number;            // 累計獲得金額（売却した金額の合計）
  consecutiveSuccesses: number;        // 連続成功回数
  fishCaughtCounts: Map<string, number>; // 魚種ごとの釣果数（key: 魚ID, value: 釣果数）
}
```

---

## 3. 実装の流れ

### 3-1. 実績定義ファイルの作成
`src/data/achievementConfig.ts` を作成し、全実績を定義

### 3-2. 実績チェック関数の実装
- `checkAchievements()`: プレイヤーデータをチェックして達成した実績を検出
- `unlockAchievement()`: 実績を解除し、報酬を付与
- `getAchievementProgress()`: 実績の進捗率を取得（0.0〜1.0）

### 3-3. 実績UIの実装
- 実績一覧画面（モーダル）
- カテゴリ別タブ
- 進捗バー表示
- 獲得済み/未獲得の視覚的区別
- 実績獲得時の通知（トースト/ポップアップ）

### 3-4. 実績チェックのタイミング
- 魚を釣った時（`successFishing()`）
- 魚を売却した時（`sellFish()`）
- レベルアップした時（`addExp()`）
- アイテムを購入した時（ショップ）
- 図鑑に登録した時（`addFishToInventory()`）

---

## 4. UIデザイン案

### 4-1. 実績一覧画面
```
┌─────────────────────────────────────┐
│  🏆 実績一覧                    [×] │
├─────────────────────────────────────┤
│ [釣果] [レア度] [図鑑] [レベル] ... │ ← タブ
├─────────────────────────────────────┤
│                                     │
│  ✅ 初めての一匹 🎣                 │
│     初めて魚を釣る                  │
│                                     │
│  ✅ 10匹達成 🐟                     │
│     合計10匹の魚を釣る              │
│                                     │
│  ⬜ 100匹達成 🐠                     │
│     合計100匹の魚を釣る             │
│     [████░░░░] 67/100               │ ← 進捗バー
│                                     │
└─────────────────────────────────────┘
```

### 4-2. 実績獲得通知
```
┌─────────────────────────┐
│  🏆 実績解除！          │
│                         │
│  100匹達成 🐠           │
│  合計100匹の魚を釣る    │
│                         │
│  [報酬: +500G]          │
└─────────────────────────┘
```

### 4-3. ステータスUIへの追加
- 実績ボタンを追加（右上など）
- 未読の新規実績がある場合はバッジ表示

---

## 5. 実装の優先順位

### Phase 1: 基本実装
1. ✅ データ構造の定義
2. ✅ 実績定義ファイルの作成（主要な実績10〜15個）
3. ✅ 実績チェック関数の実装
4. ✅ プレイヤーデータへの統合

### Phase 2: UI実装
5. ✅ 実績一覧画面（モーダル）
6. ✅ 実績獲得通知
7. ✅ ステータスUIへの実績ボタン追加

### Phase 3: 拡張
8. ✅ 全実績の追加（30〜40個）
9. ✅ 報酬システムの実装
10. ✅ 実績の統計表示

---

## 6. 技術的な考慮事項

### 6-1. パフォーマンス
- 実績チェックは必要なタイミングのみ実行
- 大量の実績がある場合、条件に合致するもののみチェック

### 6-2. データ互換性
- 既存のプレイヤーデータに実績フィールドを追加する際の互換性を保つ
- `loadPlayerData()` でデフォルト値を設定

### 6-3. 進捗の追跡
- 実績の進捗をリアルタイムで更新
- 進捗バーで視覚的に表示

---

## 7. 実装ファイル構成

```
src/
├── data/
│   ├── achievementConfig.ts    # 実績定義
│   └── inventory.ts            # 実績チェック関数を追加
├── scenes/
│   └── GameScene.ts            # 実績UI、チェック呼び出し
└── style.css                   # 実績UIのスタイル
```

---

## 8. 次のステップ（4-4: 称号システム）

実績システムの後に、称号システムを実装：
- 実績の達成状況に応じて称号を獲得
- 称号を装備して表示
- 称号ごとのボーナス効果（オプション）

---

## まとめ

実績システムは以下の要素で構成：
1. **30〜40個の実績**を定義
2. **カテゴリ別**に整理
3. **進捗追跡**でプレイヤーの成長を可視化
4. **報酬システム**で達成感を高める
5. **UI**で見やすく表示

実装は段階的に進め、まずは主要な実績から始める。
